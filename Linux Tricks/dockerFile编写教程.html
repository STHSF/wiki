<!DOCTYPE HTML>
<html>
<head>
    <link rel="Stylesheet" type="text/css" href="/wiki/static/css/style.css">
    <link rel="Stylesheet" type="text/css" href="/wiki/static/css/tango.css">
    <link rel="shortcut icon" href="/wiki/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/wiki/favicon.ico" type="image/x-icon">
    <title>DokcerFile编写教程 - LiYu's personal knowledge wiki</title>
    <meta name="keywords" content="Technology, MachineLearning, DataMining, Economics"/>
    <meta name="description" content="A wiki website of sthsf when I learned new knowledgy and technics."/>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width" />

    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
          tex2jax: {inlineMath: [['$(',')$'], ['\\(','\\)']]}
        });
        </script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>


    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-78529611-1', 'auto');
        ga('send', 'pageview');

    </script>
</head>

<body>
<div id="container">
    
<div id="header">
  <div id="post-nav"><a href="/wiki/">Home</a>&nbsp;»&nbsp;<a href="/wiki/#Linux Tricks">Linux Tricks</a>&nbsp;»&nbsp;DokcerFile编写教程</div>
</div>
<div class="clearfix"></div>
<div id="title">DokcerFile编写教程</div>
<div id="content">
  <div class="toc"><span class="toctitle">Table of Contents</span><ul>
<li><a href="#_1">写在前面</a></li>
<li><a href="#dockerfile">Dockerfile基础知识</a><ul>
<li><a href="#1">1) 常用命令列表</a><ul>
<li><a href="#maintainer">MAINTAINER</a></li>
<li><a href="#run">RUN</a></li>
<li><a href="#copy">COPY</a></li>
<li><a href="#add">ADD</a></li>
<li><a href="#expose">EXPOSE</a></li>
<li><a href="#user">USER</a></li>
<li><a href="#workdir">WORKDIR</a></li>
<li><a href="#env">ENV</a></li>
<li><a href="#volume">VOLUME</a></li>
<li><a href="#cmd">CMD</a></li>
<li><a href="#entrypoint">ENTRYPOINT</a></li>
<li><a href="#demo">简单的demo</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#1_1">1、基础镜像</a><ul>
<li><a href="#dockerfile_1">基础镜像的Dockerfile</a></li>
</ul>
</li>
<li><a href="#2">2、项目镜像</a></li>
<li><a href="#3">3、容器管理</a></li>
<li><a href="#4kubernetes">4、kubernetes管理容器</a></li>
<li><a href="#_2">参考文献</a></li>
</ul>
</div>
<h1 id="_1">写在前面</h1>
<h1 id="dockerfile">Dockerfile基础知识</h1>
<h2 id="1">1) 常用命令列表</h2>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>部分</td>
<td>命令</td>
</tr>
<tr>
<td>基础镜像信息</td>
<td>FROM</td>
</tr>
<tr>
<td>维护者信息</td>
<td>MAINTAINER</td>
</tr>
<tr>
<td>镜像操作指令</td>
<td>RUN、COPY、ADD、EXPOSE、WORKDIR、ONBUILD、USER、VOLUME等</td>
</tr>
<tr>
<td>容器启动时执行指令</td>
<td>CMD、ENTRYPOINT</td>
</tr>
<tr>
<td>## 2) 各命令详解</td>
<td></td>
</tr>
<tr>
<td>### FROM</td>
<td></td>
</tr>
<tr>
<td>指定一个镜像作为当前镜像的基础镜像, 如:</td>
<td></td>
</tr>
</tbody>
</table>
<div class="hlcode"><pre><span class="n">FROM</span> <span class="n">ubuntu</span><span class="o">:</span><span class="mf">16.04</span>
</pre></div>


<h3 id="maintainer">MAINTAINER</h3>
<p>指明该镜像的作者和电子邮件, 如:</p>
<div class="hlcode"><pre><span class="nx">MAINTAINER</span> <span class="o">&lt;</span><span class="nx">aiministrator</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="nx">aimin</span><span class="p">@</span><span class="mi">163</span><span class="bp">.</span><span class="nx">com</span><span class="o">&gt;</span>
</pre></div>


<h3 id="run">RUN</h3>
<p>在新镜像内部运行对应的命令, 主要用于新建文件, 文件目录, 安装软件, 配置一些基础信息等, 如:</p>
<div class="hlcode"><pre>RUN mkdir /home/work/workspace <span class="se">\</span>
    <span class="nb">echo</span> <span class="s2">&quot;hello word&quot;</span> &gt; <span class="se">\ </span>
    /home/work/hello.txt <span class="se">\</span>
    apt-get install -y python3.5
</pre></div>


<p>可以使用换行符<code>\</code>来进行换行操作.</p>
<p>当然, 也可以使用exec的格式的命令, 如:"RUN ["executable", "param1", "param2"]", 其中, executable是命令, 后面的param是参数.</p>
<div class="hlcode"><pre><span class="n">RUN</span> <span class="p">[</span><span class="s">&quot;apt-get&quot;</span><span class="p">,</span> <span class="s">&quot;-y&quot;</span><span class="p">,</span> <span class="s">&quot;nginx&quot;</span><span class="p">]</span>
</pre></div>


<h3 id="copy">COPY</h3>
<p>将主机的文件复制到镜像内, 如果目的位置不存在, Docker会自动创建所需要的目录结构, 但是COPY操作只是进行单纯的复制操作, 如:</p>
<div class="hlcode"><pre><span class="n">COPY</span> <span class="n">configure</span><span class="p">.</span><span class="n">conf</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">work</span><span class="o">/</span><span class="n">workspace</span><span class="o">/</span><span class="n">src</span><span class="o">/</span>
</pre></div>


<p><strong>注意：需要复制的目录一定要放在Dockerfile文件的同级目录下</strong></p>
<h3 id="add">ADD</h3>
<p>将主机的文件复制到镜像内, 与COPY的使用方式一样, 唯一不同的就是, ADD会对压缩文件（tar, gzip, bzip2, etc）做提取和解压操作.</p>
<h3 id="expose">EXPOSE</h3>
<p>暴露镜像的端口供主机映射使用, 启动镜像时, 使用-P参数镜像指定的端口和主机的某一个端口做映射. expose可以指定多个, 如:</p>
<div class="hlcode"><pre><span class="n">EXPOSE</span> <span class="mi">22</span>
<span class="n">EXPOSE</span> <span class="mi">8080</span>
<span class="n">EXPOSE</span> <span class="mi">8989</span>
</pre></div>


<h3 id="user">USER</h3>
<p>指定该镜像以什么样的用户去执行, 如:</p>
<div class="hlcode"><pre><span class="n">USER</span> <span class="n">mongo</span>
</pre></div>


<h3 id="workdir">WORKDIR</h3>
<p>在构建镜像时, 指定工作目录, 之后的所有命令都是基于此工作目录, 如果不存在则会自动创建, 如:</p>
<div class="hlcode"><pre><span class="n">WORKDIR</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">work</span>
<span class="n">WORKDIR</span> <span class="n">src</span>
<span class="n">RUN</span> <span class="n">echo</span> <span class="s">&quot;hello word&quot;</span> <span class="o">&gt;</span> <span class="n">text</span><span class="p">.</span><span class="n">txt</span>
<span class="cp"># 最终会在/home/work/src/下面生成一个text.txt文件.</span>
</pre></div>


<h3 id="env">ENV</h3>
<p>设置docker的环境变量, 如</p>
<div class="hlcode"><pre><span class="n">ENV</span> <span class="n">CORE_DIR</span><span class="o">=/</span><span class="n">home</span><span class="o">/</span><span class="n">work</span><span class="o">/</span><span class="n">src</span>
<span class="n">ENV</span> <span class="n">SCRIPT_DIR</span><span class="o">=</span><span class="err">$</span><span class="n">CORE_DIR</span><span class="o">/</span><span class="n">script</span>
<span class="n">RUN</span> <span class="err">$</span><span class="n">SCRIPT_DIR</span><span class="o">/</span><span class="n">run</span><span class="p">.</span><span class="n">sh</span>
</pre></div>


<h3 id="volume">VOLUME</h3>
<p>用来向基于镜像创建的容器添加卷. 比如, 你可以将mongodb镜像中的存储数据的data文件指定为主机的某个文件.</p>
<div class="hlcode"><pre><span class="cp"># VOLUME 主机目录 容器目录</span>
<span class="n">VOLUME</span> <span class="n">data</span><span class="o">/</span><span class="n">db</span> <span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">onfigdb</span>
</pre></div>


<h3 id="cmd">CMD</h3>
<p>容器启动时需要执行的命令, 如</p>
<div class="hlcode"><pre><span class="n">CMD</span> <span class="n">bin</span><span class="o">/</span><span class="n">bash</span>
</pre></div>


<p>同样可以使用exec的写法,</p>
<div class="hlcode"><pre><span class="n">CMD</span> <span class="p">[</span><span class="s">&quot;bin/bash&quot;</span><span class="p">]</span>
</pre></div>


<p><strong>当有多个CMD时, 只有最后一个生效</strong></p>
<h3 id="entrypoint">ENTRYPOINT</h3>
<p>与CMD的用法一样, 但是CMD和ENTRYPOINT同样作为容器启动时执行的命令,会有以下的区别:<br />
- CMD的命令会被docker run 命令所覆盖, 但是ECTRYPOINT不会. 而是把docker run 后面的命令当作ENTRYPOINT执行命令的参数</p>
<p>如 DOckerfile中有:<br />
<code>ENTRYPOINT ["/usr/sbin/nginx"]</code><br />
  然后通过启动build之后的容器<br />
<code>docker run -it &lt;image&gt; -g "daemon off"</code><br />
  此时, <code>-g "daemon off"</code>会被当作参数传递给ENTRYPOINT, 最后执行的命令变成了<br />
<code>/usr/sbin/nginx -g "daemon off"</code><br />
- CMD和ENTRYPOINT同时存在时, CMD的指令会变成ENTRYPOINT的参数，并且此CMD提供的参数会被 docker run 后面的命令覆盖，如<br />
<code>ENTRYPOINT ["echo", "hello", "i am"]
  CMD ["docker]</code><br />
  之后启动构建之后的容器</p>
<ul>
<li>使用<code>docker run -it &lt;image&gt;</code><br />
    输出 hello i am docker</li>
<li>使用<code>docker run -it &lt;iamge&gt; "word"</code><br />
    输出<code>hello i am word</code></li>
</ul>
<h3 id="demo">简单的demo</h3>
<div class="hlcode"><pre><span class="n">FROM</span> <span class="n">ubuntu</span><span class="o">:</span><span class="mf">16.04</span>
<span class="n">MAINTAINER</span> <span class="n">jerry</span> <span class="n">jerry</span><span class="err">@</span><span class="mf">163.</span><span class="n">com</span>

<span class="n">WORKDIR</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">docker</span>
<span class="n">EXPOSE</span> <span class="mi">22</span>
<span class="n">RUN</span> <span class="n">groupadd</span> <span class="o">-</span><span class="n">r</span> <span class="n">jerry</span> <span class="o">&amp;&amp;</span> <span class="n">useradd</span> <span class="o">-</span><span class="n">r</span> <span class="o">-</span><span class="n">g</span> <span class="n">jerry</span> <span class="n">jerry</span>
<span class="n">RUN</span> <span class="n">mkdir</span> <span class="p">.</span><span class="o">/</span><span class="n">src</span>
<span class="n">USER</span> <span class="n">jerry</span>

<span class="n">ENTRYPOINT</span> <span class="p">[</span><span class="s">&quot;/bin/bash&quot;</span><span class="p">]</span>
</pre></div>


<p>build过程</p>
<div class="hlcode"><pre><span class="n">jerry</span><span class="err">@</span><span class="n">jerry</span><span class="o">:~/</span><span class="n">workshop</span><span class="o">/</span><span class="n">projects</span><span class="o">/</span><span class="n">docker_test</span><span class="err">$</span> <span class="n">sudo</span> <span class="n">docker</span> <span class="n">build</span> <span class="o">-</span><span class="n">t</span> <span class="n">dockertest</span><span class="o">:</span><span class="mf">1.0</span> <span class="p">.</span>
<span class="p">[</span><span class="n">sudo</span><span class="p">]</span> <span class="n">password</span> <span class="k">for</span> <span class="n">jerry</span><span class="o">:</span>
<span class="n">Sending</span> <span class="n">build</span> <span class="n">context</span> <span class="n">to</span> <span class="n">Docker</span> <span class="n">daemon</span>  <span class="mf">2.048</span><span class="n">kB</span>
<span class="n">Step</span> <span class="mi">1</span><span class="o">/</span><span class="mi">8</span> <span class="o">:</span> <span class="n">FROM</span> <span class="n">ubuntu</span><span class="o">:</span><span class="mf">16.04</span>
 <span class="o">---&gt;</span> <span class="mf">7e87</span><span class="n">e2b3bf7a</span>
<span class="n">Step</span> <span class="mi">2</span><span class="o">/</span><span class="mi">8</span> <span class="o">:</span> <span class="n">MAINTAINER</span> <span class="n">jerry</span> <span class="n">jerry</span><span class="err">@</span><span class="mf">163.</span><span class="n">com</span>
 <span class="o">---&gt;</span> <span class="n">Running</span> <span class="n">in</span> <span class="mi">5</span><span class="n">b2c4c331bc9</span>
<span class="n">Removing</span> <span class="n">intermediate</span> <span class="n">container</span> <span class="mi">5</span><span class="n">b2c4c331bc9</span>
 <span class="o">---&gt;</span> <span class="mi">73189</span><span class="n">b8ceeec</span>
<span class="n">Step</span> <span class="mi">3</span><span class="o">/</span><span class="mi">8</span> <span class="o">:</span> <span class="n">WORKDIR</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">docker</span>
 <span class="o">---&gt;</span> <span class="n">Running</span> <span class="n">in</span> <span class="mi">8</span><span class="n">ddfcbe19c73</span>
<span class="n">Removing</span> <span class="n">intermediate</span> <span class="n">container</span> <span class="mi">8</span><span class="n">ddfcbe19c73</span>
 <span class="o">---&gt;</span> <span class="mi">6</span><span class="n">a49fe822d3f</span>
<span class="n">Step</span> <span class="mi">4</span><span class="o">/</span><span class="mi">8</span> <span class="o">:</span> <span class="n">EXPOSE</span> <span class="mi">22</span>
 <span class="o">---&gt;</span> <span class="n">Running</span> <span class="n">in</span> <span class="n">b481784335cc</span>
<span class="n">Removing</span> <span class="n">intermediate</span> <span class="n">container</span> <span class="n">b481784335cc</span>
 <span class="o">---&gt;</span> <span class="mi">9</span><span class="n">b990c863e69</span>
<span class="n">Step</span> <span class="mi">5</span><span class="o">/</span><span class="mi">8</span> <span class="o">:</span> <span class="n">RUN</span> <span class="n">groupadd</span> <span class="o">-</span><span class="n">r</span> <span class="n">jerry</span> <span class="o">&amp;&amp;</span> <span class="n">useradd</span> <span class="o">-</span><span class="n">r</span> <span class="o">-</span><span class="n">g</span> <span class="n">jerry</span> <span class="n">jerry</span>
 <span class="o">---&gt;</span> <span class="n">Running</span> <span class="n">in</span> <span class="n">c0a84adf513f</span>
<span class="n">Removing</span> <span class="n">intermediate</span> <span class="n">container</span> <span class="n">c0a84adf513f</span>
 <span class="o">---&gt;</span> <span class="mi">8</span><span class="n">a8ea468875a</span>
<span class="n">Step</span> <span class="mi">6</span><span class="o">/</span><span class="mi">8</span> <span class="o">:</span> <span class="n">RUN</span> <span class="n">mkdir</span> <span class="p">.</span><span class="o">/</span><span class="n">src</span>
 <span class="o">---&gt;</span> <span class="n">Running</span> <span class="n">in</span> <span class="n">ebde8480c3c6</span>
<span class="n">Removing</span> <span class="n">intermediate</span> <span class="n">container</span> <span class="n">ebde8480c3c6</span>
 <span class="o">---&gt;</span> <span class="mf">47f</span><span class="mi">29299</span><span class="n">b140</span>
<span class="n">Step</span> <span class="mi">7</span><span class="o">/</span><span class="mi">8</span> <span class="o">:</span> <span class="n">USER</span> <span class="n">jerry</span>
 <span class="o">---&gt;</span> <span class="n">Running</span> <span class="n">in</span> <span class="n">cb74c81ea036</span>
<span class="n">Removing</span> <span class="n">intermediate</span> <span class="n">container</span> <span class="n">cb74c81ea036</span>
 <span class="o">---&gt;</span> <span class="mi">24</span><span class="n">d938766125</span>
<span class="n">Step</span> <span class="mi">8</span><span class="o">/</span><span class="mi">8</span> <span class="o">:</span> <span class="n">ENTRYPOINT</span> <span class="p">[</span><span class="s">&quot;/bin/bash&quot;</span><span class="p">]</span>
 <span class="o">---&gt;</span> <span class="n">Running</span> <span class="n">in</span> <span class="mi">17</span><span class="n">c9e3dca85d</span>
<span class="n">Removing</span> <span class="n">intermediate</span> <span class="n">container</span> <span class="mi">17</span><span class="n">c9e3dca85d</span>
 <span class="o">---&gt;</span> <span class="n">bd07ab03e9d9</span>
<span class="n">Successfully</span> <span class="n">built</span> <span class="n">bd07ab03e9d9</span>
<span class="n">Successfully</span> <span class="n">tagged</span> <span class="n">dockertest</span><span class="o">:</span><span class="mf">1.0</span>
</pre></div>


<p>进入docker之后,注意一些变化</p>
<div class="hlcode"><pre>root@jerry:/home/jerry/workshop/projects/docker_test# docker run -it ba0
jerry@051e0e29e94f:/usr/local/docker<span class="nv">$ </span>ls
src
</pre></div>


<p>注意, docekr的用户名和RUN产生的结果.</p>
<h1 id="1_1">1、基础镜像</h1>
<p>基础镜像是镜像中运行的项目或者启动的一些服务，都要在一个基础镜像之上才能运行这些服务，比如一个django项目或者mysql数据库等，都要在Linux操作系统之上来运行，所以打包我们自己的项目时，必须要有个基础镜像来当作我们项目运行的基础环境。</p>
<p>基础镜像一般为某个linux操作系统, 比如centos, ubuntu等. 里面可以包含一些通用的服务, 比如python版本,等等</p>
<h2 id="dockerfile_1">基础镜像的Dockerfile</h2>
<p>首先我们看一下本地机器的文件目录如下:</p>
<div class="hlcode"><pre>root@jerry:/home/jerry/workshop/projects/docker# ll
total 12
drwxr-xr-x  3 root  root  4096 Jul 18 20:08 ./
drwxrwxrwx 31 jerry jerry 4096 Jul 18 20:00 ../
-rw-r--r--  1 root  root     0 Jul 18 20:01 Dockerfile
drwxr-xr-x  2 root  root  4096 Jul 18 20:08 scripts/
</pre></div>


<p>scripts/目录下保存的是run.sh文件, 文件内容为:</p>
<div class="hlcode"><pre><span class="c">#!/bin/bash</span>

apt-get update
apt-get install -y gcc make <span class="se">\</span>
                -y wget <span class="se">\</span>
                -y net-tools <span class="se">\</span>
                -y inetutils-ping <span class="se">\</span>
                -y apt-utils
<span class="c"># python3.5</span>
wget https://www.python.org/ftp/python/3.5.4/Python-3.5.4.tgz
tar -zxvf Python-3.5.4.tgz
<span class="nb">cd </span>Python-3.5.4
./configure
make <span class="o">&amp;&amp;</span> make install

ln -s /usr/bin/python3 /usr/bin/python
rm -rf Python-3.5.4*

<span class="c"># pip3</span>
apt-get update <span class="o">&amp;&amp;</span> apt-get install -y  python3-pip
</pre></div>


<p>实际上就是简单的安装python3和pip3的过程</p>
<p>下面是一个比较简单的Dockerfile, 主要功能是基于基础镜像, 在基础镜像的基础上执行run.sh中的内容.</p>
<div class="hlcode"><pre><span class="cp"># 基础镜像为ubuntu，版本为16.04，build镜像时会自动下载</span>
<span class="n">FROM</span> <span class="n">ubuntu</span><span class="o">:</span><span class="mf">16.04</span>

<span class="cp"># 制作者信息</span>
<span class="n">MAINTAINER</span> <span class="n">liyu</span> <span class="n">liyu52577</span><span class="err">@</span><span class="mf">163.</span><span class="n">com</span>

<span class="cp"># 设置环境变量</span>
<span class="n">ENV</span> <span class="n">CODE_DIR</span><span class="o">=/</span><span class="n">opt</span><span class="o">/</span><span class="n">workshop</span>
<span class="n">ENV</span> <span class="n">DOCKER_SCRIPTS</span><span class="o">=</span><span class="err">$</span><span class="n">CODE_DIR</span><span class="o">/</span><span class="n">base_image</span><span class="o">/</span><span class="n">scripts</span>

<span class="cp"># 将scripts下的文件复制到镜像中的DOCKER_SCRIPTS目录</span>
<span class="n">COPY</span> <span class="p">.</span><span class="o">/</span><span class="n">scripts</span><span class="o">/*</span> <span class="err">$</span><span class="n">DOCKER_SCRIPTS</span><span class="o">/</span>

<span class="cp"># 执行镜像中的provision.sh脚本</span>
<span class="n">RUN</span> <span class="n">chmod</span> <span class="n">a</span><span class="o">+</span><span class="n">x</span> <span class="err">$</span><span class="n">DOCKER_SCRIPTS</span><span class="o">/*</span>
<span class="n">RUN</span> <span class="err">$</span><span class="n">DOCKER_SCRIPTS</span><span class="o">/</span><span class="n">run</span><span class="p">.</span><span class="n">sh</span>
</pre></div>


<p>其中, run.sh脚本里面的内通, 当然,你也可以直接在dockerfile里面使用RUN编写一些安装过程</p>
<p>Dockerfile文件编写完成之后,执行下面的命令</p>
<div class="hlcode"><pre>docker build -t &lt;REPOSITORY&gt;:&lt;TAG&gt;
</pre></div>


<p>这样,就可以生成一个基础镜像了.</p>
<p>当然, 也可以有另外的方式进行安装, 比如, 我们可以直接pull一个纯净的镜像, 然后启动镜像, 在contanier中执行所需要的安装, 安装完成之后可以直接push成image, 这个image跟上面Dockerfile启动的基本上应该没什么区别</p>
<h1 id="2">2、项目镜像</h1>
<p>基础镜像中包含了通用的一些信息, 这些信息大部分项目中都可能会用到, 或者需要跟某些正式环境中相互一致的信息, 而项目镜像中则需要根据不同项目的需求安装自己的库.比如某个项目需要使用到http和tcp服务等. 同时还可以把自己的项目代码通过Dockerfile复制到容器内, 熟练使用将会非常方便的部署Docker</p>
<p>项目镜像的Dockerfile：</p>
<div class="hlcode"><pre><span class="cp">#基础镜像</span>
<span class="n">FROM</span> <span class="n">ubuntu_base</span><span class="o">:</span><span class="mf">1.2</span>

<span class="cp">#语言编码设置</span>
<span class="n">RUN</span> <span class="n">localedef</span> <span class="o">-</span><span class="n">c</span> <span class="o">-</span><span class="n">f</span> <span class="n">UTF</span><span class="o">-</span><span class="mi">8</span> <span class="o">-</span><span class="n">i</span> <span class="n">zh_CN</span> <span class="n">zh_CN</span><span class="p">.</span><span class="n">utf8</span>
<span class="n">ENV</span> <span class="n">LC_ALL</span> <span class="n">zh_CN</span><span class="p">.</span><span class="n">UTF</span><span class="o">-</span><span class="mi">8</span>

<span class="cp">#将项目目录文件复制到镜像中,CODE_DIR是在基础镜像中定义的</span>
<span class="n">COPY</span> <span class="p">.</span><span class="o">/</span><span class="n">jerry</span> <span class="err">$</span><span class="n">CODE_DIR</span><span class="o">/</span><span class="n">jerry</span><span class="o">/</span>

<span class="cp">#安装项目依赖包</span>
<span class="n">RUN</span> <span class="n">pip</span> <span class="n">install</span> <span class="o">-</span><span class="n">r</span> <span class="err">$</span><span class="n">CODE_DIR</span><span class="o">/</span><span class="n">jerry</span><span class="o">/</span><span class="n">requirements</span><span class="p">.</span><span class="n">txt</span>

<span class="cp">#暴露端口</span>
<span class="n">EXPOSE</span> <span class="mi">8989</span>

<span class="cp">#启动项目</span>
<span class="n">CMD</span> <span class="p">[</span><span class="s">&quot;python&quot;</span><span class="p">,</span> <span class="s">&quot;/opt/workshop/jerry/src/hello.py&quot;</span><span class="p">]</span>
</pre></div>


<h1 id="3">3、容器管理</h1>
<h1 id="4kubernetes">4、kubernetes管理容器</h1>
<h1 id="_2">参考文献</h1>
<p><a href="https://blog.csdn.net/wo18237095579/article/details/80540571">Docker Dockerfile 定制镜像</a></p>
<p><a href="https://blog.csdn.net/luanpeng825485697/article/details/81256680">将应用制作成镜像发布到服务器k8s上作为容器微服务运行</a></p>
<p><a href="https://blog.csdn.net/bocai_xiaodaidai/article/details/92838984">python项目打包成docker镜像并发布</a></p>
<p><a href="https://www.cnblogs.com/sammy1989/p/9406899.html">python项目代码打包成Docker镜像</a></p>
<p><a href=""></a></p>
</div>
<div id="content-footer">created in <span class="create-date date"> 2019-06-02 00:00 </span></div>
<div id="comments"></div>
<link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">
<script src="https://imsun.github.io/gitment/dist/gitment.browser.js"></script>
<script type="text/javascript">
const gitment = new Gitment({
  title: 'DokcerFile编写教程',
  owner: 'sthsf',
  repo: 'wiki',
  oauth: {
    client_id: '086c54c5fd95adfdc372',
    client_secret: '2ad9ebe87b952d2c77fccf99c334881b91eaa73d',
  },
  // ...
  // For more available options, check out the documentation below
})
gitment.render('comments')
// or
// gitment.render(document.getElementById('comments'))
// or
// document.body.appendChild(gitment.render())
</script>

</div>
<div id="footer">
            <span>
                Copyright © 2019 LiYu.
                Powered by <a href="http://simiki.org/" target="_blank">Simiki</a>.
                Fork me in <a href="https://github.com/sthsf/wiki" target="_blank"> github </a>.
            </span>
</div>


<!--百度统计-->
<script>
    var _hmt = _hmt || [];
    (function() {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?90e1dcdd1938573c19f9ff6521188e91";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script>


</body>
</html>